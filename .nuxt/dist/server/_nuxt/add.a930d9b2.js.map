{"version":3,"file":"add.a930d9b2.js","sources":["../../../../pages/[name].itl.wiki/setting/emplayees/add.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"sot\"><p href='#'>Настройки /</p><p href='#'> Сотрудники /</p><p href=\"#\">Добавление сотрудников</p> </div> \r\n        <div class=\"add_s\"><span >Добавление пользователя</span></div>\r\n        <InputMail :message=\"message\" @create=\"MailValue\" :error=\"error\" :left=\"430\" :top=\"135\" :width=\"470\" :placeholder=\"'Введите email адресса через запятую или пробел'\"/>\r\n        <SelectStatus :top=\"280\" :left=\"430\" @add_role=\"save_role\"/>\r\n        <button @click=\"Add_users()\" class=\"button create_text\">Выслать приглашение</button>\r\n    </div>\r\n</template>\r\n<script>\r\nimport { useTeamsStore } from '~~/stores/Teams'\r\nimport { useThePrivateStore } from '~~/stores/private'\r\ndefinePageMeta ({\r\n  layout: \"company\",\r\n  middleware: ['auth', 'team'],\r\n})\r\nexport default {\r\n    setup(){\r\n     const teams = useTeamsStore()\r\n     const priv = useThePrivateStore()\r\n     return{teams, priv}\r\n    },\r\n    data() {\r\n        \r\n        return{\r\n            update: false,\r\n            error: false,\r\n            email: '',\r\n            role: '',\r\n            Array_email: [],\r\n            message: ''\r\n        }\r\n    },\r\n\r\n    methods:{\r\n        async Add_users(){\r\n        this.email = (this.email.trim()).replaceAll(' ',',')\r\n        this.Array_email = this.email.split(',')\r\n        for (var i = 0; i< this.Array_email.length; i++) {\r\n            if ((this.Array_email[i].search(/[A-Z0-9._%+-]+@[A-Z0-9-]+\\.[A-Z]{2,4}/igm))===-1) {\r\n                this.error=true\r\n                break;\r\n            }else {if (this.Array_email.length-i===1) {   //если переданы правильно адресса, срабатывает запрос\r\n                const url = new URL(\r\n            \"https://api.wiki.itl.systems/team/employees/add\"\r\n            );\r\n\r\n            const headers = {\r\n           \"Authorization\": \"Bearer \"+this.priv.token,\r\n           \"Content-Type\": \"application/json\",\r\n           \"Accept\": \"application/json\",\r\n           };\r\n\r\n           let body = {\r\n           \"team_id\": this.teams.session_TeamID,\r\n           \"role\": this.role,\r\n           \"emails\": this.Array_email\r\n            };\r\n\r\n           const {error, data} = await useFetch(url, {\r\n           method: \"POST\",\r\n           headers,\r\n           body: JSON.stringify(body),\r\n           })\r\n           if (data.value){\r\n            navigateTo('/'+this.teams.session_TeamCode+'.itl.wiki/setting/emplayees')\r\n           }else{\r\n            this.error=true\r\n            this.message='ошибочка'\r\n           }\r\n            }\r\n            \r\n            }\r\n        }\r\n        },\r\n        save_role(role) {\r\n         this.role = role\r\n        },\r\n      MailValue(link){\r\n        this.email=link\r\n        this.error=false\r\n      }\r\n\r\n    }\r\n}\r\n</script>\r\n<style lang=\"scss\" scored>\r\n@import \"@/assets/scss/button.scss\";\r\n@import \"@/assets/scss/font_family.scss\";\r\n.button{\r\n    position: absolute;\r\n    left: 430px;\r\n    top: 360px;\r\n    width: 210px;\r\n}\r\n.add_s{\r\nposition: absolute;\r\nwidth: 300px;\r\nleft: 430px;\r\ntop: 90px;\r\nfont-family: \"Roboto_regular\";\r\nfont-size: 20px;\r\n}\r\n.sot{\r\n    display: flex;\r\n    flex-wrap: nowrap;\r\n    position: absolute;\r\n    width: 400px;\r\n    height: 20px;\r\n    left: 430px;\r\n    top: 30px;\r\n    text-decoration: none;\r\n    cursor: pointer;\r\n    font-family: \"Roboto_regular\";\r\n    font-size: 13px;\r\n    color: #999999;\r\n    p:hover{\r\n        text-decoration: underline;\r\n    }\r\n}\r\n</style>"],"names":["_sfc_main","teams","priv","i","url","body","error","data","useFetch","headers","navigateTo","role","link","$data","$options","_cache","$event"],"mappings":"2YAgBA,MAAAA,EAAA,CACI,OAAA,mBAGC,MAAA,CAAA,MAAAC,EAAA,KAAAC,CAAA,GAED,MAAA,CAEI,MAAA,oBAGI,MAAA,GACA,KAAA,GACA,YAAA,CAAA,EACA,QAAA,EACJ,GAGJ,QAAA,CACI,MAAA,WAAA,kDAEA,KAAA,YAAA,KAAA,MAAA,MAAA,GAAA,EACA,QAAAC,EAAA,EAAAA,EAAA,KAAA,YAAA,OAAAA,IACI,GAAA,KAAA,YAAAA,GAAA,OAAA,0CAAA,IAAA,GAAA,CACI,KAAA,MAAA,QAEJ,SAAA,KAAA,YAAA,OAAAA,IAAA,EAAA,CACI,MAAAC,EAAA,IAAA,0DAKL,cAAA,UAAA,KAAA,KAAA,MACA,eAAA,8CAIA,IAAAC,EAAA,CACA,QAAA,KAAA,MAAA,eACA,KAAA,KAAA,8BAIA,KAAA,CAAA,MAAAC,EAAA,KAAAC,CAAA,EAAA,MAAAC,EAAAJ,EAAA,eAEA,QAAAK,yCAGAF,EAAA,MACCG,EAAA,IAAA,KAAA,MAAA,iBAAA,6BAAA,GAEA,KAAA,MAAA,mEAGA,GAKJ,UAAAC,EAAA,cAGF,UAAAC,EAAA,CACE,KAAA,MAAAA,EACA,KAAA,MAAA,EACF,CAEF,CACJ,0jBAhFoB,QAAAC,EAAA,QAAmB,SAAAC,EAAA,UAAoB,MAAAD,EAAA,MAAe,KAAA,IAAY,IAAA,IAAW,MAAA,IAAa,YAAA,6QACvF,IAAA,IAAW,KAAA,IAAY,WAAAC,EAAA,8CAC7B,QAAAC,EAAA,KAAAA,EAAA,GAAAC,GAAAF,EAAA,UAAA,GAAoB,MAAA"}