import{_ as U}from"./section_window.67ebd6b3.js";import{_ as X}from"./changing_access.02a54b60.js";import{_ as z,a as F}from"./chain.e6a16fc3.js";import{n as V}from"../server.mjs";import{openBlock as v,createElementBlock as k,createVNode as E,createElementVNode as r,unref as G,createBlock as H,createCommentVNode as w,toDisplayString as h,createTextVNode as g,withDirectives as q,vShow as I}from"vue";import{a as M,u as W,c as u}from"./private.7b9915f8.js";import{u as Q}from"./SectionStore.63b2f3c7.js";import{u as Z}from"./ArticleStore.7b5f5aed.js";import{E as K}from"./editor.f8dcc403.js";import{H as Y,L as $,I as tt,Q as et,C as it,D as st,R as at,T as ot,W as nt,a as rt}from"./bundle.b38a729e.js";import{_ as ct}from"./pencil.90349105.js";import{_ as lt}from"./_plugin-vue_export-helper.a1a6add7.js";import"./NavbarStore.1846ce18.js";import"./folder.dc2c6812.js";import"#internal/nitro";import"vue-router";const dt={setup(){const n=Q(),s=M(),a=W(),c=Z(),e=new K({tools:{header:{class:Y,inlineToolbar:["link"]},list:{class:$,inlineToolbar:!0},image:{class:tt},quote:{class:et},code:{class:it},delimiter:{class:st},raw:{class:at},table:{class:ot},warning:{class:nt},checklist:{class:rt}},readOnly:!0,holder:"editorjss",onReady:()=>{d()},onChange:()=>{}});async function d(){const t=new URL("https://api.wiki.itl.systems/team/article/edit"),o={team_id:a.session_TeamID,article_id:c.article_id};Object.keys(o).forEach(m=>t.searchParams.append(m,o[m]));const l={Authorization:"Bearer "+s.token,"Content-Type":"application/json",Accept:"application/json"};await u(t,{method:"GET",headers:l},"$cEBpVUAPND").then(m=>p(m.data.value.data.article.tabs))}function p(t){var o=[],l="/&23948",m="/&22903",f="/&92834";for(let i=0;i<=t.length-1;i++)switch(t[i].type){case"paragraph":o.push({id:t[i].id,type:"paragraph",data:{text:t[i].content}});break;case"header":var T=t[i].content.split(l),O=T[0],B=T[1];o.push({id:t[i].id,type:"header",data:{text:O,level:B}});break;case"list":var j=t[i].content.split(l),L=j[0],N=j[1].split(f);o.push({id:t[i].id,type:"list",data:{style:L,items:N}});break;case"quote":var b=t[i].content.split(l),P=b[0],R=b[1],J=b[2];o.push({id:t[i].id,type:"quote",data:{text:P,caption:R,alignment:J}});break;case"code":o.push({id:t[i].id,type:"code",data:{code:t[i].content}});break;case"delimiter":o.push({id:t[i].id,type:"delimiter",data:{}});break;case"raw":o.push({id:t[i].id,type:"raw",data:{html:t[i].content}});break;case"table":var S=t[i].content.split(l),y=S[1].split(m);for(let _=0;_<=y.length-1;_++)y[_]=y[_].split(f);o.push({id:t[i].id,type:"table",data:{withHeadings:S[0],content:y}});break;case"warning":var x=t[i].content.split(l);o.push({id:t[i].id,type:"warning",data:{title:x[0],message:x[1]}});break;case"checklist":var C=t[i].content.split(l),A=[];for(let _=0;_<=C.length-1;_++){let D=C[_].split(f);A.push({text:D[0],checked:D[1]})}o.push({id:t[i].id,type:"checklist",data:{items:A}});break}e.blocks.render({time:1550476186479,blocks:o,version:"2.8.1"})}return{sect:n,priv:s,teams:a,article:c,editor:e}},created(){setTimeout(()=>{this.info_article()},500)},data(){return{article_data:[],editor_obj:{},otchai:!1}},methods:{async delete_perm(){const n=new URL("https://api.wiki.itl.systems/team/abilities/delete"),s={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let a={team_id:this.teams.session_TeamID,entity_type:"article",entity_id:this.article.article_id,user_id:147};fetch(n,{method:"POST",headers:s,body:JSON.stringify(a)})},async edit_role(n,s){const a=new URL("https://api.wiki.itl.systems/team/abilities/edit"),c={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let e={team_id:this.teams.session_TeamID,entity_type:"article",entity_id:this.article.article_id,permission:n};if(typeof s=="object")for(let d=0;d<=s.length-1;d++)e.user_id=s[d].id,u(a,{method:"POST",headers:c,body:JSON.stringify(e)},"$ZPi20ufJFu");else e.user_id=s,u(a,{method:"POST",headers:c,body:JSON.stringify(e)},"$mBJwTOSNaa")},save(){this.editor.save().then(n=>{this.editor_obj.blocks=n.blocks})},async info_article(){const n=new URL("https://api.wiki.itl.systems/team/article/edit"),s=new URL("https://api.wiki.itl.systems/team/article"),a={team_id:this.teams.session_TeamID,article_id:this.article.article_id};Object.keys(a).forEach(p=>{n.searchParams.append(p,a[p]),s.searchParams.append(p,a[p])});const c={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"},{data:e}=await u(n,{method:"GET",headers:c},"$M2oGsb02rp"),{data:d}=await u(s,{method:"GET",headers:c},"$y8b4w9zFic");this.article_data={info_edit:e.value.data,info_public:d.value.data}},import_data(n){var s=["\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"];let a=new Date(n);var c=a.getDate()+" "+s[a.getMonth()]+" "+a.toTimeString().slice(0,5);return c}}},pt={key:0},_t=r("img",{src:F},null,-1),mt=[_t],ht=r("img",{src:ct},null,-1),ut=[ht],yt={class:"hhiLLu"},vt={class:"huyt"},ft={class:"description"},bt={class:"postDes"},kt={class:"meaning"},wt={class:"postDes"},gt={class:"meaning"},Tt={id:"editorjss"},jt={key:0};function St(n,s,a,c,e,d){const p=U,t=X,o=z;return v(),k("div",null,[e.article_data.info_public?(v(),k("div",pt,[E(p),r("div",{onClick:s[0]||(s[0]=l=>e.otchai=!e.otchai),class:"otchai"},mt),r("div",{onClick:s[1]||(s[1]=l=>G(V)("/"+this.teams.session_TeamCode+".itl.wiki/section/"+this.sect.current_section+"/items/"+this.article.article_id+"/edit")),class:"pencil"},ut),E(t,{onFor_whom:d.edit_role,type_entity:2,id_entity:c.article.article_id,onClick:s[2]||(s[2]=l=>e.otchai=!1),left:1200,top:42},null,8,["onFor_whom","id_entity"]),e.otchai?(v(),H(o,{key:0,left:1300,top:90,left_arrw:385,type_entity:1,id_entity:this.article.article_id},null,8,["id_entity"])):w("",!0),r("div",yt,h(e.article_data.info_public.article.section.name+"/"+e.article_data.info_public.article.name),1),r("div",vt,h(e.article_data.info_public.article.name),1),r("div",ft,[r("div",bt,[g(" \u0410\u0432\u0442\u043E\u0440:\xA0"),r("div",kt,h(e.article_data.info_public.article.creator.fullname),1),g("\xA0 ")]),r("div",wt,[g(" \xA0\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E:\xA0 "),r("div",gt,h(d.import_data(e.article_data.info_public.article.updated_at)),1)])])])):w("",!0),q(r("div",Tt,[e.editor_obj.blocks?(v(),k("div",jt,[r("span",null,h(e.editor_obj),1)])):w("",!0)],512),[[I,e.article_data.info_public]])])}const Vt=lt(dt,[["render",St]]);export{Vt as default};
//# sourceMappingURL=index.a3344cac.js.map
