import{_ as U}from"./changing_access.02a54b60.js";import{n as X}from"../server.mjs";import{openBlock as y,createElementBlock as f,createElementVNode as n,unref as z,createTextVNode as v,createVNode as J,toDisplayString as m,createCommentVNode as g,withDirectives as V,vShow as H}from"vue";import{a as I,u as q,c as u}from"./private.7b9915f8.js";import{u as F}from"./ArticleStore.7b5f5aed.js";import{u as G}from"./SectionStore.63b2f3c7.js";import{E as Q}from"./editor.f8dcc403.js";import{H as W,L as K,I as M,Q as Y,C as Z,D as $,R as tt,T as et,W as it,a as st}from"./bundle.b38a729e.js";import{_ as at}from"./pencil.90349105.js";import{_ as ot}from"./_plugin-vue_export-helper.a1a6add7.js";import"#internal/nitro";import"vue-router";const rt=""+globalThis.__buildAssetsURL("circle_ug.fc68cef1.png");const nt={setup(){const o=I(),i=q(),a=F(),c=G(),s=new Q({tools:{header:{class:W,inlineToolbar:["link"]},list:{class:K,inlineToolbar:!0},image:{class:M},quote:{class:Y},code:{class:Z},delimiter:{class:$},raw:{class:tt},table:{class:et},warning:{class:it},checklist:{class:st}},readOnly:!0,holder:"editorjsc",onReady:()=>{l()},onChange:()=>{}});async function l(){const t=new URL("https://api.wiki.itl.systems/team/article/edit"),r={team_id:i.session_TeamID,article_id:a.article_id};Object.keys(r).forEach(h=>t.searchParams.append(h,r[h]));const p={Authorization:"Bearer "+o.token,"Content-Type":"application/json",Accept:"application/json"};await u(t,{method:"GET",headers:p},"$z5oJTK4iYH").then(h=>d(h.data.value.data.article.tabs))}function d(t){var r=[],p="/&23948",h="/&22903",k="/&92834";for(let e=0;e<=t.length-1;e++)switch(t[e].type){case"paragraph":r.push({id:t[e].id,type:"paragraph",data:{text:t[e].content}});break;case"header":var T=t[e].content.split(p),E=T[0],R=T[1];r.push({id:t[e].id,type:"header",data:{text:E,level:R}});break;case"list":var j=t[e].content.split(p),O=j[0],L=j[1].split(k);r.push({id:t[e].id,type:"list",data:{style:O,items:L}});break;case"quote":var w=t[e].content.split(p),N=w[0],P=w[1],B=w[2];r.push({id:t[e].id,type:"quote",data:{text:N,caption:P,alignment:B}});break;case"code":r.push({id:t[e].id,type:"code",data:{code:t[e].content}});break;case"delimiter":r.push({id:t[e].id,type:"delimiter",data:{}});break;case"raw":r.push({id:t[e].id,type:"raw",data:{html:t[e].content}});break;case"table":var x=t[e].content.split(p),b=x[1].split(h);for(let _=0;_<=b.length-1;_++)b[_]=b[_].split(k);r.push({id:t[e].id,type:"table",data:{withHeadings:x[0],content:b}});break;case"warning":var C=t[e].content.split(p);r.push({id:t[e].id,type:"warning",data:{title:C[0],message:C[1]}});break;case"checklist":var S=t[e].content.split(p),A=[];for(let _=0;_<=S.length-1;_++){let D=S[_].split(k);A.push({text:D[0],checked:D[1]})}r.push({id:t[e].id,type:"checklist",data:{items:A}});break}s.blocks.render({time:1550476186479,blocks:r,version:"2.8.1"})}return{priv:o,teams:i,article:a,editor:s,sect:c}},created(){setTimeout(()=>{this.info_article()},500)},data(){return{article_data:[],editor_obj:{},chain:!1}},methods:{async publish_art(){const o=new URL("https://api.wiki.itl.systems/team/article/publish"),i={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let a={team_id:this.teams.session_TeamID,article_id:this.article.article_id};u(o,{method:"POST",headers:i,body:JSON.stringify(a)},"$frrRciIYC0").then(()=>{})},async edit_role(o,i){const a=new URL("https://api.wiki.itl.systems/team/abilities/edit"),c={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let s={team_id:this.teams.session_TeamID,entity_type:"article",entity_id:this.article.article_id,permission:o};if(typeof i=="object")for(let l=0;l<=i.length-1;l++)s.user_id=i[l].id,u(a,{method:"POST",headers:c,body:JSON.stringify(s)},"$nlxhahKDPB");else s.user_id=i,u(a,{method:"POST",headers:c,body:JSON.stringify(s)},"$lQkswwvUWk")},save(){this.editor.save().then(o=>{this.editor_obj.blocks=o.blocks})},async info_article(){const o=new URL("https://api.wiki.itl.systems/team/article/edit"),i=new URL("https://api.wiki.itl.systems/team/article"),a={team_id:this.teams.session_TeamID,article_id:this.article.article_id};Object.keys(a).forEach(d=>{o.searchParams.append(d,a[d]),i.searchParams.append(d,a[d])});const c={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"},{data:s}=await u(o,{method:"GET",headers:c},"$hw4MDEbwNe"),{data:l}=await u(i,{method:"GET",headers:c},"$Z1leV9508S");this.article_data={info_edit:s.value.data,info_public:l.value.data}},import_data(o){var i=["\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"];let a=new Date(o);var c=a.getDate()+" "+i[a.getMonth()]+" "+a.toTimeString().slice(0,5);return c}}},ct={key:0},lt=n("img",{src:at},null,-1),dt=n("img",{src:rt},null,-1),pt=n("span",null,"\u041E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u0442\u044C",-1),_t=[dt,pt],ht={class:"hillplis"},mt={class:"difstack"},ut={key:0,class:"lkj"},vt={class:"spt"},bt={class:"postDes"},yt={class:"meaning"},ft={class:"postDes"},kt={class:"meaning"},wt={id:"editorjsc"},gt={key:0};function Tt(o,i,a,c,s,l){const d=U;return y(),f("div",null,[s.article_data.info_public?(y(),f("div",ct,[n("div",{onClick:i[0]||(i[0]=t=>z(X)("/"+this.teams.session_TeamCode+".itl.wiki/my_works/"+c.article.article_id+"/edit")),class:"kiut"},[lt,v("\u041F\u0440\u0430\u0432\u043A\u0430")]),J(d,{text:"\u0443 \u0432\u0441\u0435\u0445",onFor_whom:l.edit_role,type_entity:2,id_entity:c.article.article_id,onClick:i[1]||(i[1]=t=>s.chain=!1),left:1200,top:42},null,8,["onFor_whom","id_entity"]),n("div",{onClick:i[2]||(i[2]=t=>l.publish_art()),class:"plio"},_t),n("div",ht,m(s.article_data.info_public.article.name+"/\u041F\u0435\u0440\u0432\u0438\u0447\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F"),1),n("div",mt,[v(m(s.article_data.info_public.article.name)+" ",1),s.article_data.info_public.article.status_id<3?(y(),f("div",ut,m(s.article_data.info_public.article.status_id===1?"\u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A":"\u043D\u0430 \u043C\u043E\u0434\u0435\u0440\u0430\u0446\u0438\u0438"),1)):g("",!0)]),n("div",vt,[n("div",bt,[v(" \u0410\u0432\u0442\u043E\u0440:\xA0"),n("div",yt,m(s.article_data.info_public.article.creator.fullname),1),v("\xA0 ")]),n("div",ft,[v(" \xA0\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E:\xA0 "),n("div",kt,m(l.import_data(s.article_data.info_public.article.updated_at)),1)])])])):g("",!0),V(n("div",wt,[s.editor_obj.blocks?(y(),f("div",gt,[n("span",null,m(s.editor_obj),1)])):g("",!0)],512),[[H,s.article_data.info_public]])])}const Bt=ot(nt,[["render",Tt]]);export{Bt as default};
//# sourceMappingURL=index.b8640bb5.js.map
