import{_ as X}from"./changing_access.02a54b60.js";import{n as B}from"../server.mjs";import{openBlock as b,createElementBlock as y,createElementVNode as c,unref as F,createTextVNode as h,createVNode as J,toDisplayString as m,createCommentVNode as g,withDirectives as V,vShow as W}from"vue";import{a as q,u as z,c as u}from"./private.7b9915f8.js";import{u as H}from"./ArticleStore.7b5f5aed.js";import{E as U}from"./editor.f8dcc403.js";import{H as G,L as I,I as M,Q,C as Z,D as K,R as Y,T as $,W as tt,a as et}from"./bundle.b38a729e.js";import{_ as it}from"./pencil.90349105.js";import{_ as st}from"./_plugin-vue_export-helper.a1a6add7.js";import"./SectionStore.63b2f3c7.js";import"#internal/nitro";import"vue-router";const at={setup(){const n=q(),s=z(),o=H(),r=new U({tools:{header:{class:G,inlineToolbar:["link"]},list:{class:I,inlineToolbar:!0},image:{class:M},quote:{class:Q},code:{class:Z},delimiter:{class:K},raw:{class:Y},table:{class:$},warning:{class:tt},checklist:{class:et}},readOnly:!0,holder:"editorjss",onReady:()=>{i()},onChange:()=>{}});async function i(){const t=new URL("https://api.wiki.itl.systems/team/article/edit"),a={team_id:s.session_TeamID,article_id:o.article_id};Object.keys(a).forEach(_=>t.searchParams.append(_,a[_]));const d={Authorization:"Bearer "+n.token,"Content-Type":"application/json",Accept:"application/json"};await u(t,{method:"GET",headers:d},"$qjeso3zZCl").then(_=>l(_.data.value.data.article.tabs))}function l(t){var a=[],d="/&23948",_="/&22903",f="/&92834";for(let e=0;e<=t.length-1;e++)switch(t[e].type){case"paragraph":a.push({id:t[e].id,type:"paragraph",data:{text:t[e].content}});break;case"header":var w=t[e].content.split(d),D=w[0],O=w[1];a.push({id:t[e].id,type:"header",data:{text:D,level:O}});break;case"list":var T=t[e].content.split(d),A=T[0],R=T[1].split(f);a.push({id:t[e].id,type:"list",data:{style:A,items:R}});break;case"quote":var k=t[e].content.split(d),N=k[0],L=k[1],P=k[2];a.push({id:t[e].id,type:"quote",data:{text:N,caption:L,alignment:P}});break;case"code":a.push({id:t[e].id,type:"code",data:{code:t[e].content}});break;case"delimiter":a.push({id:t[e].id,type:"delimiter",data:{}});break;case"raw":a.push({id:t[e].id,type:"raw",data:{html:t[e].content}});break;case"table":var j=t[e].content.split(d),v=j[1].split(_);for(let p=0;p<=v.length-1;p++)v[p]=v[p].split(f);a.push({id:t[e].id,type:"table",data:{withHeadings:j[0],content:v}});break;case"warning":var x=t[e].content.split(d);a.push({id:t[e].id,type:"warning",data:{title:x[0],message:x[1]}});break;case"checklist":var C=t[e].content.split(d),E=[];for(let p=0;p<=C.length-1;p++){let S=C[p].split(f);E.push({text:S[0],checked:S[1]})}a.push({id:t[e].id,type:"checklist",data:{items:E}});break}r.blocks.render({time:1550476186479,blocks:a,version:"2.8.1"})}return{priv:n,teams:s,article:o,editor:r}},created(){setTimeout(()=>{this.info_article()},500)},data(){return{article_data:[],editor_obj:{},chain:!1}},methods:{async edit_role(n,s){const o=new URL("https://api.wiki.itl.systems/team/abilities/edit"),r={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let i={team_id:this.teams.session_TeamID,entity_type:"article",entity_id:this.article.article_id,permission:n};if(typeof s=="object")for(let l=0;l<=s.length-1;l++)i.user_id=s[l].id,u(o,{method:"POST",headers:r,body:JSON.stringify(i)},"$F8wWNmWbdI");else i.user_id=s,u(o,{method:"POST",headers:r,body:JSON.stringify(i)},"$isTcVMnEbg")},save(){this.editor.save().then(n=>{this.editor_obj.blocks=n.blocks})},async info_article(){const n=new URL("https://api.wiki.itl.systems/team/article/edit"),s=new URL("https://api.wiki.itl.systems/team/article"),o={team_id:this.teams.session_TeamID,article_id:this.article.article_id};Object.keys(o).forEach(t=>{n.searchParams.append(t,o[t]),s.searchParams.append(t,o[t])});const r={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"},{data:i}=await u(n,{method:"GET",headers:r},"$rtDkEKjJhm"),{data:l}=await u(s,{method:"GET",headers:r},"$OJbReWTF8Z");this.article_data={info_edit:i.value.data,info_public:l.value.data}},import_data(n){var s=["\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"];let o=new Date(n);var r=o.getDate()+" "+s[o.getMonth()]+" "+o.toTimeString().slice(0,5);return r}}},ot={key:0},rt=c("img",{src:it},null,-1),nt={class:"HelOu"},ct={class:"heeead"},lt={key:0,class:"status"},dt={class:"description"},pt={class:"postDes"},_t={class:"meaning"},mt={class:"postDes"},ht={class:"meaning"},ut={id:"editorjss"},vt={key:0};function bt(n,s,o,r,i,l){const t=X;return b(),y("div",null,[i.article_data.info_public?(b(),y("div",ot,[c("div",{onClick:s[0]||(s[0]=a=>F(B)("/"+this.teams.session_TeamCode+".itl.wiki/my_works/"+r.article.article_id+"/edit")),class:"pencil"},[rt,h("\u041F\u0440\u0430\u0432\u043A\u0430")]),J(t,{text:"\u0443 \u0432\u0441\u0435\u0445",onFor_whom:l.edit_role,type_entity:2,id_entity:r.article.article_id,onClick:s[1]||(s[1]=a=>i.chain=!1),left:1200,top:42},null,8,["onFor_whom","id_entity"]),c("div",nt,m(i.article_data.info_public.article.name+"/\u041F\u0435\u0440\u0432\u0438\u0447\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F"),1),c("div",ct,[h(m(i.article_data.info_public.article.name)+" ",1),i.article_data.info_public.article.status_id<3?(b(),y("div",lt,m(i.article_data.info_public.article.status_id===1?"\u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A":"\u043D\u0430 \u043C\u043E\u0434\u0435\u0440\u0430\u0446\u0438\u0438"),1)):g("",!0)]),c("div",dt,[c("div",pt,[h(" \u0410\u0432\u0442\u043E\u0440:\xA0"),c("div",_t,m(i.article_data.info_public.article.creator.fullname),1),h("\xA0 ")]),c("div",mt,[h(" \xA0\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E:\xA0 "),c("div",ht,m(l.import_data(i.article_data.info_public.article.updated_at)),1)])])])):g("",!0),V(c("div",ut,[i.editor_obj.blocks?(b(),y("div",vt,[c("span",null,m(i.editor_obj),1)])):g("",!0)],512),[[W,i.article_data.info_public]])])}const Ot=st(at,[["render",bt]]);export{Ot as default};
//# sourceMappingURL=index.708ca14f.js.map
