import{_ as m,a as f}from"./list_section.b08b4afc.js";import{_ as v}from"./changing_access.02a54b60.js";import{c as a,n as k}from"../server.mjs";import{openBlock as c,createElementBlock as w,withDirectives as _,createVNode as u,vShow as y,createElementVNode as r,normalizeClass as g,createBlock as S,createCommentVNode as C,vModelText as x,unref as b}from"vue";import{a as T,u as E,b as j,c as A}from"./private.7b9915f8.js";import{u as M}from"./SectionStore.63b2f3c7.js";import{E as N}from"./editor.f8dcc403.js";import{_ as O}from"./_plugin-vue_export-helper.a1a6add7.js";import"./NavbarStore.1846ce18.js";import"#internal/nitro";import"vue-router";const R={setup(){const s=T(),e=E(),i=j(),t=M();return{editor:new N({tools:{},holder:"editorjs"}),priv:s,teams:e,user:i,sect:t}},data(){return{h_sec:"",uSer:"",permission:"",parent:"",vis_select:!1,link_section:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0437\u0434\u0435\u043B",error:!1,block:!1,alert:""}},methods:{async delet(){const s=new URL("https://api.wiki.itl.systems/team/section/delete"),e={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let i={section_id:this.parent,team_id:this.teams.session_TeamID};const{data:t,error:o}=await A(s,{method:"POST",headers:e,body:JSON.stringify(i)},"$R34EeXNWqy");if(!t.value)switch(o.value.statusCode){case 401:throw a({statusCode:401,statusMessage:"the session is over",fatal:!0});case 500:throw a({statusCode:500,statusMessage:"invalid request",fatal:!0});case 400:throw a({statusCode:400,statusMessage:"\u0417\u0430\u043F\u0440\u043E\u0441\u0443 \u043D\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"});case 429:throw this.priv.Delete_token,a({statusCode:400,statusMessage:"\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u043C\u043D\u043E\u0433\u043E \u0437\u0430\u043F\u0440\u043E\u0441\u043E\u0432",fatal:!0})}},get_per(s,e){this.uSer=e,this.permission=s},get_parent(s,e,i){if(i&&(this.block=!0),this.parent=s,typeof e=="object")for(let t=0;t<=e.length;t++)t===0?(this.link_section="",this.link_section+=e[t]):e[t]!==void 0&&(this.link_section+="/"+e[t]);else this.link_section=e},test_save(){this.h_sec!=""?this.block?(this.error=!0,this.alert="\u0412\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0439 \u0440\u0430\u0437\u0434\u0435\u043B \u043D\u0435 \u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D"):this.editor.save().then(s=>{this.sect.Add_section(this.permission,this.uSer,s,this.h_sec,this.parent)}).catch(s=>{console.log("\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F EditorJS: ",s)}):(this.error=!0,this.alert="\u0412\u044B \u043D\u0435 \u0432\u0432\u0435\u043B\u0438 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435!")}}},B=["value"],D=r("div",{id:"editorjs"},null,-1);function V(s,e,i,t,o,l){const d=m,p=f,h=v;return c(),w("div",null,[_(u(d,{top:0,alert:o.alert},null,8,["alert"]),[[y,o.error]]),r("div",{class:g([{heads:!0},{eRror:o.error}])},[o.vis_select?(c(),S(p,{key:0,onSelected:l.get_parent,left:230,left_arrw:20,top:130},null,8,["onSelected"])):C("",!0),r("input",{class:"RR",type:"text",value:o.link_section,onClick:e[0]||(e[0]=n=>o.vis_select=!o.vis_select),readonly:""},null,8,B),u(h,{type_entity:2,id_entity:t.sect.current_section,text:"\u0414\u043E\u0441\u0442\u0443\u043F",width_input:80,width_img:14,height_img:15,onFor_whom:l.get_per,left:5,left_window:430,left_arrw:5,top:18},null,8,["id_entity","onFor_whom"]),r("div",null,[_(r("input",{class:"HH","onUpdate:modelValue":e[1]||(e[1]=n=>o.h_sec=n),type:"text",placeholder:"\u0417\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A \u0441\u0442\u0430\u0442\u044C\u0438"},null,512),[[x,o.h_sec]])]),r("button",{onClick:e[2]||(e[2]=(...n)=>l.test_save&&l.test_save(...n)),class:"OP"},"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0440\u0430\u0437\u0434\u0435\u043B"),r("button",{onClick:e[3]||(e[3]=n=>b(k)("/"+t.teams.session_TeamCode+".itl.wiki/section/"+t.sect.current_section)),class:"OT"},"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C"),r("button",{style:{top:"100px"},onClick:e[4]||(e[4]=n=>l.delet()),class:"OT"},"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"),D],2)])}const G=O(R,[["render",V]]);export{G as default};
//# sourceMappingURL=add.24fb3e75.js.map
