import{_ as b,a as w}from"./list_section.e0adecd0.js";import{_ as C,a as T}from"./chain.0fca7cf4.js";import{_ as x}from"./changing_access.27dfb36f.js";import{_ as S,a as j,b as A}from"./EL.46b50029.js";import{a as B,m as u,b as f,w as v,k as L,j as k,e as a,c as p,h as _,v as R,u as U,f as E,o as c}from"./entry.19428e20.js";import{u as H,d as N,a as V,b as g}from"./private.d82c0789.js";import{u as z}from"./SectionStore.763b80b6.js";import{u as J}from"./ArticleStore.89b32673.js";import{E as O}from"./editor.135d3e60.js";import{H as P,L as q,I as D,Q as F,C as M,D as Q,R as W,T as G,W as I,a as X}from"./bundle.f96f1759.js";import"./NavbarStore.7e812d0d.js";const K={setup(){const o=z(),e=H(),i=N(),t=V(),s=J();return{editor:new O({tools:{header:{class:P,inlineToolbar:["link"]},list:{class:q,inlineToolbar:!0},image:{class:D},quote:{class:F},code:{class:M},delimiter:{class:Q},raw:{class:W},table:{class:G},warning:{class:I},checklist:{class:X}},holder:"editorjs"}),priv:e,teams:i,user:t,sect:o,article:s}},data(){return{tag:!1,errors:!1,alert:"",h_name:"",link_section:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0437\u0434\u0435\u043B",vis_list:!1,parent:"",act:[],check_pub:!1,vis_sh:!1,additionally:!1}},methods:{pub(o){this.check_pub=o},save_act(o,e){if(typeof e!="object")this.act=[{user_id:e,permission:o}];else for(let i=0;i<=e.length-1;i++)this.act.push({user_id:e[i].id,permission:o})},get_parent(o,e){if(this.parent=o,typeof e=="object")for(let i=0;i<=e.length-1;i++)i===0?(this.link_section="",this.link_section+=e[i]):e[i]!==void 0&&(this.link_section+="/"+e[i]);else this.link_section=e},add_content_blocks(o){var e=o;for(let t=0;t<=e.length-1;t++)switch(e[t].type){case"paragraph":e[t].name=e[t].type+"_"+t,e[t].content=e[t].data.text;break;case"header":e[t].name=e[t].type+"_"+t,e[t].content=e[t].data.text+"/&23948"+e[t].data.level;break;case"list":e[t].name=e[t].type+"_"+t,e[t].content=e[t].data.style+"/&23948"+e[t].data.items.join("/&92834");break;case"quote":e[t].name=e[t].type+"_"+t,e[t].content=e[t].data.text+"/&23948"+e[t].data.caption+"/&23948"+e[t].data.alignment;break;case"code":e[t].name=e[t].type+"_"+t,e[t].content=e[t].data.code;break;case"delimiter":e[t].name=e[t].type+"_"+t;break;case"raw":e[t].name=e[t].type+"_"+t,e[t].content=e[t].data.html;break;case"table":e[t].name=e[t].type+"_"+t;var i="";for(let s=0;s<=e[t].data.content.length-1;s++)i+=e[t].data.content[s].join("/&92834"),e[t].data.content.length-2>=s&&(i+="/&22903");e[t].content=e[t].data.withHeadings+"/&23948"+i;break;case"warning":e[t].name=e[t].type+"_"+t,e[t].content=e[t].data.title+"/&23948"+e[t].data.message;break;case"checklist":e[t].name=e[t].type+"_"+t;var i="";for(let s=0;s<=e[t].data.items.length-1;s++)i+=e[t].data.items[s].text+"/&92834"+e[t].data.items[s].checked,e[t].data.items.length-2>=s&&(i+="/&23948");e[t].content=i;break}return e},async test_save(o){this.h_name!==""&&this.parent!=""?this.editor.save().then(e=>{e.blocks.length===0&&(this.errors=!0,this.alert="\u0441\u043E\u0434\u0435\u0440\u0436\u0430\u043D\u0438\u0435 \u0441\u0442\u0430\u0442\u044C\u0438 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u0430");var i=this.add_content_blocks(e.blocks);const t=new URL("https://api.wiki.itl.systems/team/article/add"),s={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let n={team_id:this.teams.session_TeamID,section_id:this.parent,action:o,name:this.h_name,tabs:{...i}};this.act.length>=1&&(n.abilities={...this.act}),g(t,{method:"POST",headers:s,body:JSON.stringify(n)},"$R3EVz4uCqU").then(r=>{if(o===3){if(this.article.use_article(r.data.value.data.article.name,r.data.value.data.article.id),this.check_pub){const d=new URL("https://api.wiki.itl.systems/team/article/mode"),m={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let h={team_id:this.teams.session_TeamID,article_id:this.article.article_id,public:1};g(d,{method:"POST",headers:m,body:JSON.stringify(h)},"$ihXDB1iGiP")}u("/"+this.teams.session_TeamCode+".itl.wiki/section/"+this.sect.current_section+"/items/"+this.article.article_id)}else r.error.value===null&&u("/"+this.teams.session_TeamCode+".itl.wiki/")})}).catch(e=>{console.log("\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F: ",e)}):(this.alert="\u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435/\u043F\u0443\u0442\u044C/\u0441\u043E\u0434\u0435\u0440\u0436\u0430\u043D\u0438\u0435 \u0441\u0442\u0430\u0442\u044C\u0438 \u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u044B",this.errors=!0)}}},Y=["value"],Z=a("img",{src:S},null,-1),$=a("span",null,"\u0422\u0435\u0433\u0438",-1),ee=[Z,$],te=a("img",{src:j},null,-1),se=[te],ie=a("img",{src:T},null,-1),ae=a("span",null,"\u041F\u043E\u0434\u0435\u043B\u0438\u0442\u044C\u0441\u044F",-1),oe=[ie,ae],ne=a("div",{id:"editorjs"},null,-1),le={key:3},re=a("div",{class:"are"},null,-1),ce={class:"additionally"},_e=a("span",null,"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A",-1),de=[_e];function me(o,e,i,t,s,n){const r=b,d=C,m=w,h=x,y=A;return c(),f("div",null,[v(k(r,{top:0,alert:s.alert},null,8,["alert"]),[[L,s.errors]]),a("div",{class:E([{head:!0},{errors:s.errors}])},[s.vis_sh?(c(),p(d,{key:0,onCheck:n.pub,top:50,left:500,left_arrw:40},null,8,["onCheck"])):_("",!0),s.vis_list?(c(),p(m,{key:1,onSelected:n.get_parent,top:140,left:230},null,8,["onSelected"])):_("",!0),a("input",{onClick:e[0]||(e[0]=l=>{s.vis_list=!s.vis_list,s.tag=!1,s.vis_sh=!1}),class:"r",type:"text",value:s.link_section,readonly:""},null,8,Y),v(a("input",{maxlength:"25","onUpdate:modelValue":e[1]||(e[1]=l=>s.h_name=l),class:"HJU",type:"text",placeholder:"\u0417\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A \u0441\u0442\u0430\u0442\u044C\u0438"},null,512),[[R,s.h_name]]),k(h,{onClick:e[2]||(e[2]=l=>{s.vis_sh=!1,s.tag=!1,s.vis_list=!1}),width_input:80,width_img:15,height_img:16,left_arrw:15,left_window:420,onFor_whom:n.save_act,left:0,top:8,text:"\u0434\u043E\u0441\u0442\u0443\u043F"},null,8,["onFor_whom"]),a("div",{onClick:e[3]||(e[3]=l=>{s.tag=!s.tag,s.vis_list=!1,s.vis_sh=!1}),class:"tag"},ee),s.tag?(c(),p(y,{key:2,top:70,left:190,left_arrw:105})):_("",!0),a("button",{onClick:e[4]||(e[4]=l=>n.test_save(t.teams.role==="user"?2:3)),class:"op"},"\u041E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u0442\u044C"),a("button",{onClick:e[5]||(e[5]=l=>U(u)("/"+t.teams.session_TeamCode+".itl.wiki/")),class:"ot"},"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C"),a("div",{onClick:e[6]||(e[6]=l=>s.additionally=!s.additionally),class:"t"},se),a("div",{onClick:e[7]||(e[7]=l=>{s.vis_sh=!s.vis_sh,s.tag=!1,s.vis_list=!1}),class:"kou"},oe),ne,s.additionally?(c(),f("div",le,[re,a("div",ce,[a("div",{class:"lik",onClick:e[8]||(e[8]=l=>n.test_save(1))},de)])])):_("",!0)],2)])}const Te=B(K,[["render",me]]);export{Te as default};
