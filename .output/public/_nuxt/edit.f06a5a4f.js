import{_ as v,a as k}from"./list_section.e0adecd0.js";import{_ as y,a as w}from"./chain.0fca7cf4.js";import{_ as g}from"./changing_access.27dfb36f.js";import{a as C,q as u,b as S,w as p,k as m,j as d,e as n,v as x,u as b,f as T,o as j,m as E}from"./entry.19428e20.js";import{u as D,d as A,a as R,b as f}from"./private.d82c0789.js";import{u as M}from"./SectionStore.763b80b6.js";import{E as B}from"./editor.135d3e60.js";import"./NavbarStore.7e812d0d.js";const J={setup(){const i=D(),t=A(),a=R(),s=M(),e=new B({holder:"editorjs",data:{time:1550476186479,blocks:[{id:"save",type:"paragraph",data:{text:""}}],version:"2.8.1"},onReady:()=>{c()},onChange:()=>{}});function r(l){e.blocks.render({time:1550476186479,blocks:[{id:"save",type:"paragraph",data:{text:l}}],version:"2.8.1"})}async function c(){const l=new URL("https://api.wiki.itl.systems/team/section/edit"),_={team_id:t.session_TeamID,section_id:s.current_section};Object.keys(_).forEach(o=>l.searchParams.append(o,_[o]));const h={Authorization:"Bearer "+i.token,"Content-Type":"application/json",Accept:"application/json"};await f(l,{method:"GET",headers:h},"$QN3ATJ9JDx").then(o=>{r(o.data.value.data.section.content)})}return{editor:e,priv:i,teams:t,user:a,sect:s,import_data:c}},data(){return{h_sec:this.sect.current_name,uSer:"",permission:"",parent:"",vis_select:!1,link_section:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0437\u0434\u0435\u043B",error:!1,block:!1,alert:"",vis_ch:!1}},methods:{async delet(){const i=new URL("https://api.wiki.itl.systems/team/section/delete"),t={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let a={section_id:this.parent,team_id:this.teams.session_TeamID};const{data:s,error:e}=await f(i,{method:"POST",headers:t,body:JSON.stringify(a)},"$ki7V0qjDDq");if(!s.value)switch(e.value.statusCode){case 401:throw u({statusCode:401,statusMessage:"the session is over",fatal:!0});case 500:throw u({statusCode:500,statusMessage:"invalid request",fatal:!0});case 400:throw u({statusCode:400,statusMessage:"\u0417\u0430\u043F\u0440\u043E\u0441\u0443 \u043D\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"});case 429:throw this.priv.Delete_token,u({statusCode:400,statusMessage:"\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u043C\u043D\u043E\u0433\u043E \u0437\u0430\u043F\u0440\u043E\u0441\u043E\u0432",fatal:!0})}},get_per(i,t){this.uSer=t,this.permission=i},info(i){this.link_section=i},get_parent(i,t,a){if(a&&(this.block=!0),this.parent=i,typeof t=="object")for(let s=0;s<=t.length;s++)s===0?(this.link_section="",this.link_section+=t[s]):t[s]!==void 0&&(this.link_section+="/"+t[s]);else this.link_section=t},test_save(){this.h_sec!=""?this.block?(this.error=!0,this.alert="\u0412\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0439 \u0440\u0430\u0437\u0434\u0435\u043B \u043D\u0435 \u0434\u043E\u0441\u0442\u0443\u043F\u0435\u043D"):this.editor.save().then(i=>{this.sect.Edit_section(this.permission,this.uSer,i,this.h_sec,this.parent)}).catch(i=>{console.log("\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F EditorJS: ",i)}):(this.error=!0,this.alert="\u0412\u044B \u043D\u0435 \u0432\u0432\u0435\u043B\u0438 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435!")}}},L=n("img",{src:w},null,-1),O=n("span",null,"\u041F\u043E\u0434\u0435\u043B\u0438\u0442\u044C\u0441\u044F",-1),q=[L,O],z=["value"],N=n("div",{id:"editorjs"},null,-1);function P(i,t,a,s,e,r){const c=v,l=k,_=y,h=g;return j(),S("div",null,[p(d(c,{top:0,alert:e.alert},null,8,["alert"]),[[m,e.error]]),n("div",{class:T([{heads:!0},{eRror:e.error}])},[p(d(l,{onList:r.info,onClick:t[0]||(t[0]=o=>{e.vis_select=!1}),onSelected:r.get_parent,left:230,left_arrw:20,top:130},null,8,["onList","onSelected"]),[[m,e.vis_select]]),n("div",{onClick:t[1]||(t[1]=o=>e.vis_ch=!e.vis_ch),class:"chg"},q),p(d(_,{type_entity:2,id_entity:s.sect.current_section,top:60,left:500,left_arrw:60},null,8,["id_entity"]),[[m,e.vis_ch]]),n("div",{class:"RR liz",onClick:t[2]||(t[2]=o=>{e.vis_select=!e.vis_select})},[n("input",{type:"text",value:e.link_section,readonly:""},null,8,z)]),d(h,{del:!0,onClick:t[3]||(t[3]=o=>e.vis_ch=!1),type_entity:2,id_entity:s.sect.current_section,text:"\u0414\u043E\u0441\u0442\u0443\u043F",width_input:80,width_img:14,height_img:15,onFor_whom:r.get_per,left:5,left_window:430,left_arrw:5,top:18},null,8,["id_entity","onFor_whom"]),p(n("input",{class:"HH","onUpdate:modelValue":t[4]||(t[4]=o=>e.h_sec=o),type:"text",placeholder:"\u0417\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A \u0440\u0430\u0437\u0434\u0435\u043B\u0430"},null,512),[[x,e.h_sec]]),n("button",{onClick:t[5]||(t[5]=(...o)=>r.test_save&&r.test_save(...o)),class:"OP"},"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0440\u0430\u0437\u0434\u0435\u043B"),n("button",{onClick:t[6]||(t[6]=o=>b(E)("/"+s.teams.session_TeamCode+".itl.wiki/section/"+s.sect.current_section)),class:"OT"},"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C"),N],2)])}const W=C(J,[["render",P]]);export{W as default};
