import{_ as U}from"./changing_access.27dfb36f.js";import{a as X,b as y,e as n,l as v,u as z,j as J,t as m,h as g,w as V,k as H,o as f,m as I}from"./entry.19428e20.js";import{u as q,d as F,b as u}from"./private.d82c0789.js";import{u as G}from"./ArticleStore.89b32673.js";import{u as Q}from"./SectionStore.763b80b6.js";import{E as W}from"./editor.135d3e60.js";import{H as K,L as M,I as Y,Q as Z,C as $,D as tt,R as et,T as it,W as st,a as at}from"./bundle.f96f1759.js";import{_ as ot}from"./pencil.90349105.js";const rt=""+new URL("circle_ug.fc68cef1.png",import.meta.url).href;const nt={setup(){const o=q(),i=F(),a=G(),c=Q(),s=new W({tools:{header:{class:K,inlineToolbar:["link"]},list:{class:M,inlineToolbar:!0},image:{class:Y},quote:{class:Z},code:{class:$},delimiter:{class:tt},raw:{class:et},table:{class:it},warning:{class:st},checklist:{class:at}},readOnly:!0,holder:"editorjsc",onReady:()=>{l()},onChange:()=>{}});async function l(){const t=new URL("https://api.wiki.itl.systems/team/article/edit"),r={team_id:i.session_TeamID,article_id:a.article_id};Object.keys(r).forEach(h=>t.searchParams.append(h,r[h]));const p={Authorization:"Bearer "+o.token,"Content-Type":"application/json",Accept:"application/json"};await u(t,{method:"GET",headers:p},"$z5oJTK4iYH").then(h=>d(h.data.value.data.article.tabs))}function d(t){var r=[],p="/&23948",h="/&22903",k="/&92834";for(let e=0;e<=t.length-1;e++)switch(t[e].type){case"paragraph":r.push({id:t[e].id,type:"paragraph",data:{text:t[e].content}});break;case"header":var T=t[e].content.split(p),R=T[0],E=T[1];r.push({id:t[e].id,type:"header",data:{text:R,level:E}});break;case"list":var j=t[e].content.split(p),O=j[0],B=j[1].split(k);r.push({id:t[e].id,type:"list",data:{style:O,items:B}});break;case"quote":var w=t[e].content.split(p),L=w[0],N=w[1],P=w[2];r.push({id:t[e].id,type:"quote",data:{text:L,caption:N,alignment:P}});break;case"code":r.push({id:t[e].id,type:"code",data:{code:t[e].content}});break;case"delimiter":r.push({id:t[e].id,type:"delimiter",data:{}});break;case"raw":r.push({id:t[e].id,type:"raw",data:{html:t[e].content}});break;case"table":var x=t[e].content.split(p),b=x[1].split(h);for(let _=0;_<=b.length-1;_++)b[_]=b[_].split(k);r.push({id:t[e].id,type:"table",data:{withHeadings:x[0],content:b}});break;case"warning":var C=t[e].content.split(p);r.push({id:t[e].id,type:"warning",data:{title:C[0],message:C[1]}});break;case"checklist":var S=t[e].content.split(p),D=[];for(let _=0;_<=S.length-1;_++){let A=S[_].split(k);D.push({text:A[0],checked:A[1]})}r.push({id:t[e].id,type:"checklist",data:{items:D}});break}s.blocks.render({time:1550476186479,blocks:r,version:"2.8.1"})}return{priv:o,teams:i,article:a,editor:s,sect:c}},created(){setTimeout(()=>{this.info_article()},500)},data(){return{article_data:[],editor_obj:{},chain:!1}},methods:{async publish_art(){const o=new URL("https://api.wiki.itl.systems/team/article/publish"),i={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let a={team_id:this.teams.session_TeamID,article_id:this.article.article_id};u(o,{method:"POST",headers:i,body:JSON.stringify(a)},"$frrRciIYC0").then(()=>{})},async edit_role(o,i){const a=new URL("https://api.wiki.itl.systems/team/abilities/edit"),c={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"};let s={team_id:this.teams.session_TeamID,entity_type:"article",entity_id:this.article.article_id,permission:o};if(typeof i=="object")for(let l=0;l<=i.length-1;l++)s.user_id=i[l].id,u(a,{method:"POST",headers:c,body:JSON.stringify(s)},"$nlxhahKDPB");else s.user_id=i,u(a,{method:"POST",headers:c,body:JSON.stringify(s)},"$lQkswwvUWk")},save(){this.editor.save().then(o=>{this.editor_obj.blocks=o.blocks})},async info_article(){const o=new URL("https://api.wiki.itl.systems/team/article/edit"),i=new URL("https://api.wiki.itl.systems/team/article"),a={team_id:this.teams.session_TeamID,article_id:this.article.article_id};Object.keys(a).forEach(d=>{o.searchParams.append(d,a[d]),i.searchParams.append(d,a[d])});const c={Authorization:"Bearer "+this.priv.token,"Content-Type":"application/json",Accept:"application/json"},{data:s}=await u(o,{method:"GET",headers:c},"$hw4MDEbwNe"),{data:l}=await u(i,{method:"GET",headers:c},"$Z1leV9508S");this.article_data={info_edit:s.value.data,info_public:l.value.data}},import_data(o){var i=["\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"];let a=new Date(o);var c=a.getDate()+" "+i[a.getMonth()]+" "+a.toTimeString().slice(0,5);return c}}},ct={key:0},lt=n("img",{src:ot},null,-1),dt=n("img",{src:rt},null,-1),pt=n("span",null,"\u041E\u043F\u0443\u0431\u043B\u0438\u043A\u043E\u0432\u0430\u0442\u044C",-1),_t=[dt,pt],ht={class:"hillplis"},mt={class:"difstack"},ut={key:0,class:"lkj"},vt={class:"spt"},bt={class:"postDes"},yt={class:"meaning"},ft={class:"postDes"},kt={class:"meaning"},wt={id:"editorjsc"},gt={key:0};function Tt(o,i,a,c,s,l){const d=U;return f(),y("div",null,[s.article_data.info_public?(f(),y("div",ct,[n("div",{onClick:i[0]||(i[0]=t=>z(I)("/"+this.teams.session_TeamCode+".itl.wiki/my_works/"+c.article.article_id+"/edit")),class:"kiut"},[lt,v("\u041F\u0440\u0430\u0432\u043A\u0430")]),J(d,{text:"\u0443 \u0432\u0441\u0435\u0445",onFor_whom:l.edit_role,type_entity:2,id_entity:c.article.article_id,onClick:i[1]||(i[1]=t=>s.chain=!1),left:1200,top:42},null,8,["onFor_whom","id_entity"]),n("div",{onClick:i[2]||(i[2]=t=>l.publish_art()),class:"plio"},_t),n("div",ht,m(s.article_data.info_public.article.name+"/\u041F\u0435\u0440\u0432\u0438\u0447\u043D\u0430\u044F \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F"),1),n("div",mt,[v(m(s.article_data.info_public.article.name)+" ",1),s.article_data.info_public.article.status_id<3?(f(),y("div",ut,m(s.article_data.info_public.article.status_id===1?"\u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A":"\u043D\u0430 \u043C\u043E\u0434\u0435\u0440\u0430\u0446\u0438\u0438"),1)):g("",!0)]),n("div",vt,[n("div",bt,[v(" \u0410\u0432\u0442\u043E\u0440:\xA0"),n("div",yt,m(s.article_data.info_public.article.creator.fullname),1),v("\xA0 ")]),n("div",ft,[v(" \xA0\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E:\xA0 "),n("div",kt,m(l.import_data(s.article_data.info_public.article.updated_at)),1)])])])):g("",!0),V(n("div",wt,[s.editor_obj.blocks?(f(),y("div",gt,[n("span",null,m(s.editor_obj),1)])):g("",!0)],512),[[H,s.article_data.info_public]])])}const Ot=X(nt,[["render",Tt]]);export{Ot as default};
